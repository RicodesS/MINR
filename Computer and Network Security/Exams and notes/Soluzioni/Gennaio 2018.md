1

- False (if we do not consider pattern in the plaintext)
- True
- False
- True
- False
- False
- False
- True
- True
- False



2.1 Let's suppose that Alice was able to retrieve $(Z_A, Z_{A}^{'})$ such that the first one is even and the second one is odd and $h(Z_A)=h(Z_A^{'})$. Then also $h(Z_A||n_A)=(Z'_A||n)$. So after retrieved the choice of B, she can decide what number send to Bob in order to win her bet $p$.

2.2 To fix this problem Alice must use nested hashes: she must send $h(n_A||h(n_B||Z_A))$, where $n_B$ is a nonce generated by Bob and sent to Alice as the first message of the protocol. In this way Alice cannot find a collision in a reasonable amount of time since the protocol is done online.



3.1 In the following protocol A will be Alice, B will be Bob (the two entities which want to authenticate each other -> mutual authentication), KDC will be the third trusted party which will be in charge to setup a session key between the two entities. Notice that each user $U$ in the network has a master key associated with the KDC $K_U$:

- A->KDC: I'm Alice I want to contact B, $N_1$, Alice contacts KDC specifying Bob as the other entity and a random number which will be the challenge which verifies that she is talking with KDC.
- KDC->A: $K_A\{A, N_1, K_{AB}, K_B\{A,K_{AB}\}=ticket_B\}$, KDC answers Alice with the solved challenge and the session key $K_{AB}$ all encrypted with the Alice's master key. Notice also the usage of entities in the messages to bind initiator with the answer. Moreover, it delivers to Alice the so called ticket which is encrypted with the Bob's master key such that no one could modify it.
- A->B: $ticket_B, K_{AB}\{N_2\}$, Alice forwards the ticket to Bob from which he will retrieve the session key $K_{AB}$ and will check the identity of the initiator. Also solves the challenge of Alice.
- B->A: $K_{AB}\{N_2-1,N_3\}$, Bob switches to the session key which is used to solve the Alice's challenge and to forward a new challenge.
- A->B: $K_{AB}\{N_3-1\}$, Alice authenticates herself with Bob.

This is an algorithm by Needham-Schroeder based on a third trusted entity for mutual authentication. Again this algorithm suffers of a problem: let's suppose that Trudy collects messages about a previous session between Alice and Bob and somehow breaks or guesses the session key $K'_{AB}$, now, in a following session, she can intercept communication between Alice and Bob before Alice sends the new ticket for Bob and impersonates Alice, forwarding to Bob the old ticket related to the broken session key $K'_{AB}$. Trudy starts the messages exchange with Bob and reaches the mutual authentication. This is because of the fact that Bob is not aware of when Alice contacts the KDC, he is not involved in the first part of the protocol. To avoid this we can apply a fix:

- A->B: I'm Alice I want to contact you, Alice contacts directly Bob and announces the protocol's start.
- B->A: $K_B\{N_b\}$, Bob wants to check the freshness of the ticket that he will received, so asks Alice to forward this nonce to the KDC. He will retrieve it in the ticket. 
- A->KDC: I'm Alice I want to contact Bob, $N_1, K_B\{N_b\}$, she forwards the Bob's challenge.
- KDC->A: $K_A\{A, N_1, K_{AB}, K_B\{A, N_B, K_{AB}\}=ticket_B\}$, KDC solves the Bob's challenge and inserts it into the ticket.
- A->B: $ticket_B, K_{AB}\{N_2\}$, Bob is now sure of the freshness of the ticket.
- B->A: $K_{AB}\{N_2-1,N_3\}$
- A->B: $K_{AB}\{N_3-1\}$, in this case this message is useless, since Alice was verified and authenticated through the KDC and the ticket.

3.2 Alice wants to communicate with Bob and Carl. Since that, there is needed a session key $K_{ABC}$ and two tickets: one for Alice to Bob, one for Alice to Carl. 

- A->B: I'm Alice I want to contact you
- B->A: $K_B\{N_B\}$
- A->C: I'm Alice I want also you in the communication
- C->A: $K_C\{N_C\}$
- A->KDC: I'm Alice I want to communicate with Bob and Carl, $N_1$, $K_B\{N_B\}$, $K_C\{N_C\}$
- KDC->A: $K_A\{A, K_{ABC}, N_1, ticket_B=\{A, C, N_B, K_{ABC}\}, ticket_C=\{A, B, N_C, K_{ABC}\}\}$
- A->B: $K_{ABC}\{N_2\}$, $ticket_B$
- B->A: $K_{ABC}\{N_2-1\}$
- A->C: $K_{ABC}\{N_3\}$, $ticket_C$
- B->A: $K_{ABC}\{N_3-1\}$

Now Alice is mutual authenticated with Bob and Carl. 

- B->C: $K_{ABC}\{N_4\}$
- C->B: $K_{ABC}\{N_4-1, N_5\}$
- B->C: $K_{ABC}\{N_5-1\}$

Now also Bob and Carl have challenged each other.

